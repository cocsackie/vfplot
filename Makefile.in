# Makefile.in for vfplot

# $Id: Makefile.in,v 1.22 2008/09/12 22:47:54 jjg Exp jjg $
# help older versions of make

@SET_MAKE@

# Macros

VERSION   = @VERSION@
RUBBISH   = *~ 
CONFFILES = config.cache config.log config.status configure Makefile

# targets

default : all

all : 
	cd src ; $(MAKE) all ; cd ..

install : 
	cd src ; $(MAKE) install ; cd ..

test check :
	cd src ; $(MAKE) test ; cd ..

profile :
	cd src ; $(MAKE) profile ; cd ..

archive :
	cd src ; $(MAKE) archive ; cd ..

txt : CREDITS.txt CHANGES.txt INSTALL.txt

man : vfplot.1 sag2grd.1 dom.5 sag.5 vgs.5
	mv vfplot.1 src/vfplot/vfplot.1
	mv sag2grd.1 src/sag2grd/sag2grd.1
	mv dom.5 src/libvfplot/dom.5
	mv sag.5 src/libvfplot/sag.5
	mv sag.5 src/libvfplot/vgs.5

clean :
	cd src ; $(MAKE) clean ; cd ..
	$(RM) $(RUBBISH)

spotless veryclean :
	cd src ; $(MAKE) veryclean ; cd ..
	$(RM) $(CONFFILES) $(RUBBISH)
	autoconf
	rm -rf autom4te.cache/

dist : man txt veryclean 
	cd .. ; \
	cp -r vfplot vfplot-$(VERSION) ;\
	cd vfplot-$(VERSION) ;\
	$(MAKE) spotless ;\
	cd .. ; \
	tar --exclude=RCS -zcvf snapshot/vfplot-$(VERSION).tar.gz vfplot-$(VERSION) ;\
	mv vfplot-$(VERSION) /tmp 

maint-dist : clean
	cd .. ; \
	tar -zcvf vfplot-maint.tar.gz vfplot ; \
	cd vfplot

# package documentation

MANXSL = /usr/share/xml/docbook/stylesheet/nwalsh/manpages/docbook.xsl

vpath %.xml xml

.SUFFIXES : .1 .5 .txt .xml

.xml.txt :
	docbook2txt $<

.xml.1 :
	xsltproc $(MANXSL) $<

.xml.5 :
	xsltproc $(MANXSL) $<

